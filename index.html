<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ï†êÏã¨ Î©îÎâ¥ Ï∂îÏ≤ú</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root {
            --primary-color: #3498db; --secondary-color: #2c3e50; --danger-color: #e74c3c;
            --success-color: #2ecc71; --light-gray: #ecf0f1; --dark-text: #34495e;
        }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; color: var(--dark-text); overflow: hidden; }
        .screen { width: 100%; height: 100%; display: flex; flex-direction: column; box-sizing: border-box; background-size: cover; background-position: center; transition: opacity 0.4s ease-in-out, background-image 0.5s ease-in-out; position: absolute; top: 0; left: 0;}
        .hidden { opacity: 0; pointer-events: none; }
        #recommendScreen { justify-content: space-between; padding: 40px 20px 20px 20px; }
        .result-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: var(--dark-text); /* ÏàòÏ†ïÎê® */
            text-shadow: none;       /* ÏàòÏ†ïÎê® */
        }
        #foodImage { width: 80%; max-width: 300px; height: auto; aspect-ratio: 1 / 1; object-fit: cover; border-radius: 20px; margin-bottom: 20px; background-color: rgba(255,255,255,0.2); transition: opacity 0.4s ease; border: 3px solid rgba(255,255,255,0.5); }
        #resultText { font-size: 24px; font-weight: bold; min-height: 70px; }
        .button-group { width: 100%; display: flex; flex-direction: column; gap: 10px; }
        .action-buttons { display: flex; gap: 10px; }
        button { width: 100%; padding: 15px; font-size: 18px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer; color: white; transition: background-color 0.2s ease; }
        .btn-main { background-color: var(--primary-color); }
        .btn-manage { background-color: var(--secondary-color); }
        .btn-action { background-color: #95a5a6; }
        .btn-back { background-color: var(--danger-color); }
        .btn-add { background-color: var(--success-color); }
        .btn-delete { background-color: var(--danger-color); }
        button:active { opacity: 0.8; }
        #manageScreen { padding: 20px; gap: 15px; background-image: url('images/manage_background.jpg'); }
        .list-container { flex-grow: 1; background-color: rgba(255,255,255,0.8); border-radius: 12px; padding: 10px; overflow-y: auto; }
        .list-item { padding: 10px; border-bottom: 1px solid #ddd; cursor: pointer; }
        .list-item.selected { background-color: var(--primary-color); color: white; border-radius: 8px; font-weight: bold; }
        .manage-buttons { display: flex; gap: 10px; }
        h2 { color: white; text-shadow: 1px 1px 2px black; margin: 10px 0 5px 0; }
    </style>
</head>
<body>
    <div id="recommendScreen" class="screen">
        <div class="result-container">
            <img id="foodImage" src="" style="opacity: 0;">
            <h1 id="resultText"></h1>
        </div>
        <div class="button-group">
            <div id="actionButtons" class="action-buttons"></div>
            <button id="recommendButton" class="btn-main">Î©îÎâ¥ Ï∂îÏ≤ú!</button>
            <button id="manageButton" class="btn-manage">Î©îÎâ¥ Í¥ÄÎ¶¨ ‚öôÔ∏è</button>
        </div>
    </div>
    <div id="manageScreen" class="screen hidden">
        <h2>Ïπ¥ÌÖåÍ≥†Î¶¨</h2>
        <div id="categoryList" class="list-container"></div>
        <div class="manage-buttons">
            <button id="addCategoryBtn" class="btn-add">Ï∂îÍ∞Ä</button>
            <button id="deleteCategoryBtn" class="btn-delete">ÏÇ≠Ï†ú</button>
        </div>
        <h2 id="menuListTitle">Î©îÎâ¥</h2>
        <div id="menuList" class="list-container"></div>
        <div class="manage-buttons">
            <button id="addMenuBtn" class="btn-add">Ï∂îÍ∞Ä</button>
            <button id="deleteMenuBtn" class="btn-delete">ÏÇ≠Ï†ú</button>
        </div>
        <button id="backButton" class="btn-back">Ï∂îÏ≤ú ÌôîÎ©¥ÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞</button>
    </div>
    <script>
        const DATA_KEY = 'lunchMenuData';
        let menuData, currentCategory = '', lastSpecificMenu = null, selectedCategory = null, selectedMenu = null;
        const recommendScreen = document.getElementById('recommendScreen'), manageScreen = document.getElementById('manageScreen'), foodImage = document.getElementById('foodImage'), resultText = document.getElementById('resultText'), actionButtons = document.getElementById('actionButtons');
        function loadData() { const savedData = localStorage.getItem(DATA_KEY); if (savedData) { return JSON.parse(savedData); } const defaultData = {"ÌïúÏãù": [{"name": "ÍπÄÏπòÏ∞åÍ∞ú", "image": "images/kimchi_jjigae.jpg"}, {"name": "Î≥¥Ïåà", "image": "images/bossam.jpg"}, {"name": "Ïú°ÌöåÎπÑÎπîÎ∞•", "image": "images/bibimbap.jpg"}, {"name": "Îñ°Î≥∂Ïù¥", "image": "images/tteokbokki.jpg"}, {"name": "ÏßúÍ∏ÄÏù¥", "image": "images/jjaguli.jpg"}, {"name": "ÍπÄÎ∞•", "image": "images/kimbap.jpg"}, {"name": "Íµ≠Î∞•", "image": "images/gukbap.jpg"}, {"name": "Íµ≠Ïàò", "image": "images/noodle.jpg"}, {"name": "ÏÉ§Î∏åÏÉ§Î∏å", "image": "images/shabushabu.jpg"}, {"name": "Îã≠Í∞àÎπÑ", "image": "images/dakgalbi.jpg"}], "Ï§ëÏãù": [{"name": "ÎßàÎùºÌÉï", "image": "images/maratang.jpg"}, {"name": "ÏßúÏû•Î©¥", "image": "images/jjajangmyeon.jpg"}, {"name": "Ïß¨ÎΩï", "image": "images/jjamppong.jpg"}, {"name": "ÎßåÎëê", "image": "images/mandu.jpg"}], "ÏùºÏãù": [{"name": "ÎèàÍπåÏä§", "image": "images/donkkaseu.jpg"}, {"name": "ÎùºÎ©ò", "image": "images/ramen.jpg"}, {"name": "Ïó∞Ïñ¥", "image": "images/salmon.jpg"}, {"name": "Ïö∞Îèô", "image": "images/udon.jpg"}, {"name": "ÎçÆÎ∞•", "image": "images/donburi.jpg"}], "ÏñëÏãù": [{"name": "ÌååÏä§ÌÉÄ", "image": "images/pasta.jpg"}, {"name": "ÌñÑÎ≤ÑÍ±∞", "image": "images/hamburger.jpg"}, {"name": "ÌîºÏûê", "image": "images/pizza.jpg"}, {"name": "ÏÉêÎü¨Îìú", "image": "images/salad.jpg"}, {"name": "ÏÉåÎìúÏúÑÏπò", "image": "images/sandwich.jpg"}]}; saveData(defaultData); return defaultData; }
        function saveData(data) { localStorage.setItem(DATA_KEY, JSON.stringify(data)); }
        function recommendCategory() { recommendScreen.style.backgroundImage = `url('images/recommend_background.jpg')`; const availableCategories = Object.keys(menuData).filter(cat => menuData[cat].length > 0); if (availableCategories.length === 0) { resultText.innerHTML = "Î©îÎâ¥Í∞Ä ÏóÜÏäµÎãàÎã§."; return; } let choice = currentCategory; if (availableCategories.length > 1) { while(choice === currentCategory) { choice = availableCategories[Math.floor(Math.random() * availableCategories.length)]; } } else { choice = availableCategories[0]; } currentCategory = choice; resultText.innerHTML = `<b>${currentCategory}</b><br><br>Ïñ¥Îñ†ÏÑ∏Ïöî?`; foodImage.style.opacity = 0; updateActionButtons('category_recommended'); }
        function recommendSpecificMenu() { const menuList = menuData[currentCategory]; if (!menuList || menuList.length === 0) return; let availableMenus = [...menuList]; if (lastSpecificMenu && availableMenus.length > 1) { availableMenus = availableMenus.filter(item => item.name !== lastSpecificMenu.name); } const choice = availableMenus[Math.floor(Math.random() * availableMenus.length)]; lastSpecificMenu = choice; resultText.innerHTML = `${currentCategory}<br><br>üëâ <b>${choice.name}</b> üëà`; foodImage.src = choice.image; foodImage.style.opacity = 1; updateActionButtons('specific_recommended'); }
        function updateActionButtons(state) { actionButtons.innerHTML = ''; if (state === 'home') return; if (state === 'category_recommended') { const btnSpecific = document.createElement('button'); btnSpecific.className = 'btn-action'; btnSpecific.textContent = 'Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú?'; btnSpecific.onclick = recommendSpecificMenu; actionButtons.appendChild(btnSpecific); } const btnReroll = document.createElement('button'); btnReroll.className = 'btn-action'; btnReroll.textContent = 'Ïã´Ïñ¥Ïöî üëé'; btnReroll.onclick = () => { if(foodImage.style.opacity == 1) recommendSpecificMenu(); else recommendCategory(); }; actionButtons.appendChild(btnReroll); const btnHome = document.createElement('button'); btnHome.className = 'btn-action'; btnHome.textContent = 'Ï≤òÏùåÏúºÎ°ú üè†'; btnHome.onclick = goToHomeScreen; actionButtons.appendChild(btnHome); }
        function goToHomeScreen() { resultText.innerHTML = ''; foodImage.src = ''; foodImage.style.opacity = 0; currentCategory = ''; lastSpecificMenu = null; recommendScreen.style.backgroundImage = `url('images/background.jpg')`; updateActionButtons('home'); }
        function showManageScreen() { updateCategoryList(); updateMenuList(); manageScreen.classList.remove('hidden'); recommendScreen.classList.add('hidden'); }
        function showRecommendScreen() { manageScreen.classList.add('hidden'); recommendScreen.classList.remove('hidden'); }
        function updateCategoryList() { const catListDiv = document.getElementById('categoryList'); catListDiv.innerHTML = ''; Object.keys(menuData).sort().forEach(cat => { const itemDiv = document.createElement('div'); itemDiv.className = 'list-item'; itemDiv.textContent = cat; if (cat === selectedCategory) { itemDiv.classList.add('selected'); } itemDiv.onclick = () => { selectedCategory = cat; selectedMenu = null; updateCategoryList(); updateMenuList(); }; catListDiv.appendChild(itemDiv); }); }
        function updateMenuList() { const menuListDiv = document.getElementById('menuList'), menuListTitle = document.getElementById('menuListTitle'); menuListDiv.innerHTML = ''; if (selectedCategory) { menuListTitle.textContent = `'${selectedCategory}' Î©îÎâ¥`; menuData[selectedCategory].sort((a, b) => a.name.localeCompare(b.name)).forEach(menu => { const itemDiv = document.createElement('div'); itemDiv.className = 'list-item'; itemDiv.textContent = menu.name; if (menu.name === selectedMenu) { itemDiv.classList.add('selected'); } itemDiv.onclick = () => { selectedMenu = menu.name; updateMenuList(); }; menuListDiv.appendChild(itemDiv); }); } else { menuListTitle.textContent = 'Î©îÎâ¥'; } }
        document.addEventListener('DOMContentLoaded', () => { menuData = loadData(); goToHomeScreen(); document.getElementById('recommendButton').onclick = recommendCategory; document.getElementById('manageButton').onclick = showManageScreen; document.getElementById('backButton').onclick = showRecommendScreen; document.getElementById('addCategoryBtn').onclick = () => { const newCat = prompt("Ï∂îÍ∞ÄÌï† Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:"); if (newCat && !menuData[newCat]) { menuData[newCat] = []; saveData(menuData); selectedCategory = newCat; updateCategoryList(); updateMenuList(); } }; document.getElementById('deleteCategoryBtn').onclick = () => { if (selectedCategory && confirm(`'${selectedCategory}' Ïπ¥ÌÖåÍ≥†Î¶¨Î•º Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) { delete menuData[selectedCategory]; saveData(menuData); selectedCategory = null; selectedMenu = null; updateCategoryList(); updateMenuList(); } }; document.getElementById('addMenuBtn').onclick = () => { if (selectedCategory) { const newMenuName = prompt(`'${selectedCategory}'Ïóê Ï∂îÍ∞ÄÌï† Î©îÎâ¥ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:`); if (!newMenuName) return; const newMenuImage = prompt(`'${newMenuName}'Ïùò Ïù¥ÎØ∏ÏßÄ Í≤ΩÎ°úÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: images/new.jpg):`, 'images/'); if (newMenuName && newMenuImage) { menuData[selectedCategory].push({name: newMenuName, image: newMenuImage}); saveData(menuData); updateMenuList(); } } }; document.getElementById('deleteMenuBtn').onclick = () => { if (selectedCategory && selectedMenu && confirm(`'${selectedMenu}' Î©îÎâ¥Î•º Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) { menuData[selectedCategory] = menuData[selectedCategory].filter(item => item.name !== selectedMenu); saveData(menuData); selectedMenu = null; updateMenuList(); } }; });
        if ('serviceWorker' in navigator) { window.addEventListener('load', () => { navigator.serviceWorker.register('/sw.js').then(reg => console.log('SW registered.')).catch(err => console.log('SW registration failed: ', err)); }); }
    </script>
</body>
</html>